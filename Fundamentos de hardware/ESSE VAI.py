import RPi.GPIO as GPIO
import time

# Configurações
BUZZER_PIN = 18  # GPIO usado para controlar o buzzer
GPIO.setmode(GPIO.BCM)
GPIO.setup(BUZZER_PIN, GPIO.OUT)

buzzer = GPIO.PWM(BUZZER_PIN, 440)  # frequência inicial
buzzer.start(0)

def beep(freq, duration):
    buzzer.ChangeFrequency(freq)
    buzzer.ChangeDutyCycle(50)
    time.sleep(duration * 0.9)
    buzzer.ChangeDutyCycle(0)
    time.sleep(duration * 0.1)

# Notas musicais (Hz)
notes = {
    'B0': 23,  'C1': 25,  'CS1': 26,  'D1': 28,  'DS1': 30,
    'E1': 31,  'F1': 34,  'FS1': 35,  'G1': 37,  'GS1': 39,
    'A1': 41,  'AS1': 44,  'B1': 46,  'C2': 49,  'CS2': 52,
    'D2': 55,  'DS2': 58,  'E2': 62,  'F2': 65,  'FS2': 69,
    'G2': 73,  'GS2': 78,  'A2': 82,  'AS2': 87,  'B2': 93,
    'C3': 98,  'CS3': 104, 'D3': 110, 'DS3': 117, 'E3': 123,
    'F3': 131, 'FS3': 139, 'G3': 147, 'GS3': 156, 'A3': 165,
    'AS3': 175, 'B3': 185, 'C4': 196, 'CS4': 208, 'D4': 220,
    'DS4': 233, 'E4': 247, 'F4': 262, 'FS4': 277, 'G4': 294,
    'GS4': 311, 'A4': 330, 'AS4': 349, 'B4': 370, 'C5': 392,
    'CS5': 415, 'D5': 440, 'DS5': 466, 'E5': 494, 'F5': 523,
    'FS5': 554, 'G5': 587, 'GS5': 622, 'A5': 659, 'AS5': 698,
    'B5': 740, 'C6': 784, 'CS6': 831, 'D6': 880, 'DS6': 932,
    'E6': 988, 'F6': 1047, 'FS6': 1109, 'G6': 1175, 'GS6': 1245,
    'A6': 1319, 'AS6': 1397, 'B6': 1480, 'C7': 1568, 'CS7': 1661,
    'D7': 1760, 'DS7': 1865, 'E7': 1976, 'F7': 2093, 'FS7': 2217,
    'G7': 2349, 'GS7': 2489, 'A7': 2637, 'AS7': 2794, 'B7': 2960,
    'C8': 3136, 'CS8': 3322, 'D8': 3520, 'DS8': 3729
}

# Música (Super Mario theme)
mario = [
    # Introdução
    ('E7', 0.12), ('E7', 0.12), (0, 0.12), ('E7', 0.12),
    (0, 0.12), ('C7', 0.12), ('E7', 0.12), (0, 0.12),
    ('G7', 0.12), (0, 0.36), ('G6', 0.12), (0, 0.36),
    
    # Primeira seção
    ('C7', 0.12), (0, 0.24), ('G6', 0.12), (0, 0.24),
    ('E6', 0.12), (0, 0.24), ('A6', 0.12), (0, 0.12),
    ('B6', 0.12), (0, 0.12), ('AS6', 0.12), ('A6', 0.12),
    
    ('G6', 0.18), ('E7', 0.18), ('G7', 0.18),
    ('A7', 0.12), (0, 0.12), ('F7', 0.12), ('G7', 0.12),
    (0, 0.12), ('E7', 0.12), (0, 0.12), ('C7', 0.12),
    ('D7', 0.12), ('B6', 0.12), (0, 0.24),
    
    # Segunda seção
    ('C7', 0.12), (0, 0.24), ('G6', 0.12), (0, 0.24),
    ('E6', 0.12), (0, 0.24), ('A6', 0.12), (0, 0.12),
    ('B6', 0.12), (0, 0.12), ('AS6', 0.12), ('A6', 0.12),
    
    ('G6', 0.18), ('E7', 0.18), ('G7', 0.18),
    ('A7', 0.12), (0, 0.12), ('F7', 0.12), ('G7', 0.12),
    (0, 0.12), ('E7', 0.12), (0, 0.12), ('C7', 0.12),
    ('D7', 0.12), ('B6', 0.12), (0, 0.24),
    
    # Ponte
    (0, 0.18), ('G7', 0.12), ('GS7', 0.12), ('A7', 0.12),
    ('F7', 0.12), ('G7', 0.12), (0, 0.12), ('E7', 0.12),
    (0, 0.12), ('C7', 0.12), ('D7', 0.12), ('B6', 0.12),
    (0, 0.18),
    
    # Terceira seção
    ('C7', 0.12), (0, 0.24), ('G6', 0.12), (0, 0.24),
    ('E6', 0.12), (0, 0.24), ('A6', 0.12), (0, 0.12),
    ('B6', 0.12), (0, 0.12), ('AS6', 0.12), ('A6', 0.12),
    
    ('G6', 0.18), ('E7', 0.18), ('G7', 0.18),
    ('A7', 0.12), (0, 0.12), ('F7', 0.12), ('G7', 0.12),
    (0, 0.12), ('E7', 0.12), (0, 0.12), ('C7', 0.12),
    ('D7', 0.12), ('B6', 0.12), (0, 0.24),
    
    # Final
    ('E7', 0.12), ('E7', 0.12), (0, 0.12), ('E7', 0.12),
    (0, 0.12), ('C7', 0.12), ('E7', 0.12), (0, 0.12),
    ('G7', 0.12), (0, 0.36), ('G6', 0.12), (0, 0.36),
    
    # Acordes finais
    ('C7', 0.18), ('G6', 0.18), ('E6', 0.18),
    ('A6', 0.15), ('B6', 0.15), ('A6', 0.12), ('GS6', 0.12), ('AS6', 0.12),
    ('GS6', 0.12), ('G6', 0.12), ('FS6', 0.12), ('G6', 0.12),
    (0, 0.12),
    
    ('C7', 0.18), ('G6', 0.18), ('E6', 0.18),
    ('A6', 0.15), ('B6', 0.15), ('A6', 0.12), ('GS6', 0.12), ('AS6', 0.12),
    ('GS6', 0.12), ('G6', 0.12), ('FS6', 0.12), ('G6', 0.12),
    
    # Finalização
    ('B6', 0.12), ('G7', 0.12), ('D7', 0.12), ('E7', 0.12),
    ('C7', 0.12), ('A6', 0.12), ('FS6', 0.12), ('G6', 0.12),
    (0, 0.24), ('E6', 0.12), ('C7', 0.12), ('A6', 0.12),
    ('G6', 0.18), (0, 0.18)
]

try:
    for note, duration in mario:
        if note == 0:
            time.sleep(duration)
        else:
            beep(notes[note], duration)
finally:
    buzzer.stop()
    GPIO.cleanup()
